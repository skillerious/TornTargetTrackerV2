<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src https://api.torn.com https://www.tornstats.com;">
    <title>Torn Target Tracker</title>
    <link rel="stylesheet" href="styles/app.css">
</head>
<body>
    <div id="app">
        <!-- ================================================================
             CUSTOM TITLEBAR
             ================================================================ -->
        <div id="titlebar">
            <div class="titlebar-left">
                <div class="titlebar-drag-region">
                    <img src="assets/logomain.png" alt="Torn Target Tracker" class="titlebar-icon titlebar-logo">
                    <span class="titlebar-title">Torn Target Tracker</span>
                    <span class="titlebar-version" id="titlebar-version">v2.0</span>
                </div>
                <nav class="titlebar-menubar" id="titlebar-menubar" aria-label="Application menu">
                    <!-- Menu items injected by app.js -->
                </nav>
            </div>
            <div class="titlebar-controls">
                <button class="titlebar-btn" id="btn-minimize" title="Minimize">
                    <svg viewBox="0 0 10 10"><path fill="currentColor" d="M0 5h10v1H0z"/></svg>
                </button>
                <button class="titlebar-btn" id="btn-maximize" title="Maximize">
                    <svg viewBox="0 0 10 10"><path fill="currentColor" d="M0 0v10h10V0H0zm1 1h8v8H1V1z"/></svg>
                </button>
                <button class="titlebar-btn close" id="btn-close" title="Close">
                    <svg viewBox="0 0 10 10"><path fill="currentColor" d="M1.41 0L5 3.59 8.59 0 10 1.41 6.41 5 10 8.59 8.59 10 5 6.41 1.41 10 0 8.59 3.59 5 0 1.41z"/></svg>
                </button>
            </div>
        </div>
        <div class="titlebar-menubar-flyout" id="titlebar-menubar-flyout" role="menu" aria-hidden="true"></div>

        <!-- ================================================================
             MAIN CONTAINER
             ================================================================ -->
        <div id="main-container">
            <!-- ============================================================
                 ACTIVITY BAR (Left icons)
                 ============================================================ -->
            <div id="activity-bar">
                <div class="activity-item active" data-view="targets" title="Targets (Ctrl+1)">
                    <img src="assets/bullseye.png" alt="Targets" class="activity-icon">
                    <span class="activity-badge" id="attackable-count" style="display: none;">0</span>
                </div>
                <div class="activity-item" data-view="history" title="History (Ctrl+2)">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>
                </div>
                <div class="activity-item" data-view="statistics" title="Statistics (Ctrl+3)">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
                </div>
                <div class="activity-item" data-view="loot-timer" title="Loot Timer (Ctrl+4)">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                </div>
                <div class="activity-item" data-view="settings" title="Settings (Ctrl+,)">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                </div>
                <div class="activity-item" id="activity-about" title="About">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M11 7h2v2h-2V7zm0 4h2v6h-2v-6zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/></svg>
                </div>
                <div class="activity-spacer"></div>
                <div class="activity-item" id="connection-status" title="Connection Status">
                    <svg viewBox="0 0 32 32" class="wifi-icon" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="wifi-grad-1" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" class="grad-start-1"/>
                                <stop offset="100%" class="grad-end-1"/>
                            </linearGradient>
                            <linearGradient id="wifi-grad-2" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" class="grad-start-2"/>
                                <stop offset="100%" class="grad-end-2"/>
                            </linearGradient>
                            <linearGradient id="wifi-grad-3" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" class="grad-start-3"/>
                                <stop offset="100%" class="grad-end-3"/>
                            </linearGradient>
                        </defs>
                        <circle cx="16" cy="26" r="2" fill="url(#wifi-grad-1)" class="wifi-dot"/>
                        <path d="M11 22c1.4-1.4 3.2-2.2 5-2.2s3.6 0.8 5 2.2" stroke="url(#wifi-grad-1)" stroke-width="2.5" fill="none" stroke-linecap="round" class="wifi-curve wifi-curve-1" data-level="1"/>
                        <path d="M7 18c2.4-2.4 5.6-3.8 9-3.8s6.6 1.4 9 3.8" stroke="url(#wifi-grad-2)" stroke-width="2.5" fill="none" stroke-linecap="round" class="wifi-curve wifi-curve-2" data-level="2"/>
                        <path d="M3 14c3.5-3.5 8.2-5.5 13-5.5s9.5 2 13 5.5" stroke="url(#wifi-grad-3)" stroke-width="2.5" fill="none" stroke-linecap="round" class="wifi-curve wifi-curve-3" data-level="3"/>
                    </svg>
                </div>
                <div class="activity-item" id="refresh-all-btn" title="Refresh All (Ctrl+R)">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                </div>
            </div>

            <!-- ============================================================
                 SIDEBAR
                 ============================================================ -->
            <div id="sidebar">
                <!-- Sidebar Header -->
                <div class="sidebar-header">
                    <span>EXPLORER</span>
                    <div class="sidebar-header-actions">
                        <button class="sidebar-header-btn sidebar-header-btn-primary" id="add-target-btn" title="Add Target (Ctrl+N)">
                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                        </button>
                        <button class="sidebar-header-btn" id="bulk-add-btn" title="Bulk Add Targets">
                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"/></svg>
                        </button>
                        <button class="sidebar-header-btn" id="collapse-all-btn" title="Collapse All">
                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 18.59L8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"/></svg>
                        </button>
                    </div>
                </div>

                <!-- Search Box -->
                <div class="sidebar-search">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                    <input type="text" id="search-input" placeholder="Search targets...">
                    <button class="search-clear" id="search-clear" style="display: none;">
                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                    </button>
                </div>

                <!-- Groups Section -->
                <div class="sidebar-section">
                    <div class="section-header" id="groups-section-header">
                        <svg class="chevron" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                        <span>Groups</span>
                        <button class="section-action-btn" id="add-group-btn" title="Add Group">
                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                        </button>
                    </div>
                    <div class="section-content" id="groups-list">
                        <div class="group-item active" data-group="all">
                            <span class="group-color" style="background: #007acc;"></span>
                            <span class="group-name">All Targets</span>
                            <span class="group-count" id="group-all-count">0</span>
                        </div>
                        <!-- Dynamic groups will be added here -->
                    </div>
                </div>

                <!-- Filters Section -->
                <div class="sidebar-section">
                    <div class="section-header" id="filters-section-header">
                        <svg class="chevron" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                        <span>Filters</span>
                    </div>
                    <div class="section-content">
                        <div class="filter-item active" data-filter="all">
                            <span class="filter-icon status-dot status-unknown"></span>
                            <span class="filter-name">All</span>
                            <span class="filter-count" id="filter-all-count">0</span>
                        </div>
                        <div class="filter-item" data-filter="okay">
                            <span class="filter-icon status-dot status-okay"></span>
                            <span class="filter-name">Attackable</span>
                            <span class="filter-count" id="filter-okay-count">0</span>
                        </div>
                        <div class="filter-item" data-filter="hospital">
                            <span class="filter-icon status-dot status-hospital"></span>
                            <span class="filter-name">Hospital</span>
                            <span class="filter-count" id="filter-hospital-count">0</span>
                        </div>
                        <div class="filter-item" data-filter="jail">
                            <span class="filter-icon status-dot status-jail"></span>
                            <span class="filter-name">Jail</span>
                            <span class="filter-count" id="filter-jail-count">0</span>
                        </div>
                        <div class="filter-item" data-filter="traveling">
                            <span class="filter-icon status-dot status-traveling"></span>
                            <span class="filter-name">Traveling</span>
                            <span class="filter-count" id="filter-traveling-count">0</span>
                        </div>
                        <div class="filter-item" data-filter="favorites">
                            <span class="filter-icon">â˜…</span>
                            <span class="filter-name">Favorites</span>
                            <span class="filter-count" id="filter-favorites-count">0</span>
                        </div>
                        <div class="filter-item" data-filter="errors">
                            <span class="filter-icon status-dot status-error"></span>
                            <span class="filter-name">Errors</span>
                            <span class="filter-count" id="filter-errors-count">0</span>
                        </div>
                    </div>
                </div>

                <!-- Targets Section -->
                <div class="sidebar-section targets-section">
                    <div class="section-header" id="targets-section-header">
                        <svg class="chevron" viewBox="0 0 24 24"><path fill="currentColor" d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                        <span>Targets</span>
                        <span class="section-count" id="targets-count">(0)</span>
                    </div>
                    <div class="section-content">
                        <!-- Sort bar -->
                        <div class="sort-bar">
                            <button class="sort-btn active" data-sort="name" title="Sort by name">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
                            </button>
                            <button class="sort-btn" data-sort="level" title="Sort by level">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/></svg>
                            </button>
                            <button class="sort-btn" data-sort="status" title="Sort by status">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                            </button>
                            <button class="sort-btn" data-sort="lastAction" title="Sort by last action">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                            </button>
                            <button class="sort-btn" data-sort="favorite" title="Sort by favorite">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            </button>
                        </div>
                        <!-- Target list -->
                        <div class="target-list" id="target-list">
                            <!-- Targets rendered here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ============================================================
                 MAIN CONTENT AREA
                 ============================================================ -->
            <div id="content">
                <!-- Targets Panel -->
                <div class="content-panel active" id="panel-targets">
                    <!-- Target Detail View -->
                    <div class="target-detail" id="target-detail" style="display: none;">
                        <div class="target-detail-header">
                            <div class="target-hero-left">
                                <div class="target-avatar" id="detail-avatar">
                                    <span class="avatar-initials" id="detail-avatar-initials">TT</span>
                                    <span class="avatar-loader"></span>
                                </div>
                                <div class="target-title-block">
                                    <div class="target-title-row">
                                        <div class="target-name-stack">
                                            <h2>
                                                <span id="detail-name">Target Name</span>
                                                <span class="user-id">[<span id="detail-id">0</span>]</span>
                                            </h2>
                                            <div class="target-chip-row">
                                                <span class="chip" id="detail-level-chip">Lv. 0</span>
                                                <span class="chip chip-faction" id="detail-faction-chip">No faction</span>
                                                <span class="chip chip-status-chip" id="detail-status-chip">Status</span>
                                                <span class="chip chip-difficulty" id="detail-difficulty-chip">Difficulty</span>
                                                <span class="chip chip-muted" id="detail-updated-chip">Updated --</span>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                        <div class="target-hero-right">
                            <button class="watch-btn-topright" id="detail-watch-btn" title="Toggle Status Watch">
                                <img src="assets/alert.png" alt="Watch status">
                            </button>
                            <button class="favorite-btn-topright" id="detail-favorite-btn" title="Toggle Favorite">
                                <svg class="star-empty" viewBox="0 0 24 24"><path fill="currentColor" d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"/></svg>
                                <svg class="star-filled" viewBox="0 0 24 24"><path fill="currentColor" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            </button>
                                <div class="target-detail-status">
                                    <span class="status-badge" id="detail-status-badge">OKAY</span>
                                    <span class="status-timer" id="detail-timer"></span>
                                </div>
                                <div class="target-detail-actions">
                                    <button class="action-btn primary" id="btn-attack" title="Attack (Enter)">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
                                        Attack
                                    </button>
                                    <button class="action-btn" id="btn-profile" title="View Profile">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                                        Profile
                                    </button>
                                    <button class="action-btn" id="btn-refresh-target" title="Refresh">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                                    </button>
                                    <button class="action-btn danger" id="btn-remove-target" title="Remove (Delete)">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="target-detail-body">
                            <div class="detail-columns">
                                <!-- Left Column - Info -->
                                <div class="detail-column">
                                    <div class="detail-section">
                                        <h3>
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                                            Information
                                        </h3>
                                        <div class="detail-grid">
                                            <div class="detail-row">
                                                <span class="detail-label">Level</span>
                                                <span class="detail-value" id="detail-level">-</span>
                                            </div>
                                            <div class="detail-row">
                                                <span class="detail-label">Faction</span>
                                                <span class="detail-value" id="detail-faction">-</span>
                                            </div>
                                            <div class="detail-row" data-detail-row="tags">
                                                <span class="detail-label">Tags</span>
                                                <div class="detail-value tag-list" id="detail-tags">-</div>
                                            </div>
                                            <div class="detail-row" data-detail-row="status">
                                                <span class="detail-label">Status</span>
                                                <span class="detail-value" id="detail-status-desc">-</span>
                                            </div>
                                        <div class="detail-row" data-detail-row="last-action">
                                            <span class="detail-label">Last Action</span>
                                            <span class="detail-value" id="detail-last-action">-</span>
                                        </div>
                                        <div class="detail-row">
                                            <span class="detail-label">Last Updated</span>
                                            <span class="detail-value" id="detail-updated">-</span>
                                        </div>
                                        <div class="detail-row">
                                            <span class="detail-label">Added</span>
                                            <span class="detail-value" id="detail-added">-</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="detail-section" id="detail-intel-section">
                                    <div class="detail-section-header">
                                        <h3>
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20a10 10 0 0 0 0-20zm0 18a8 8 0 1 1 0-16a8 8 0 0 1 0 16zm-1-9H7v2h4v4h2v-4h4v-2h-4V7h-2v4z"/></svg>
                                            Target Intelligence
                                        </h3>
                                        <div class="intel-actions">
                                            <span class="intel-status" id="detail-intel-status">No intel</span>
                                            <button class="icon-btn" id="btn-refresh-intel" title="Refresh intelligence">
                                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 6V3L8 7l4 4V8c2.76 0 5 2.24 5 5a5 5 0 0 1-8.54 3.54l-1.42 1.42A7 7 0 0 0 19 13c0-3.86-3.14-7-7-7zm-5 7a5 5 0 0 1 8.54-3.54l1.42-1.42A7 7 0 0 0 5 13c0 3.86 3.14 7 7 7v3l4-4-4-4v3c-2.76 0-5-2.24-5-5z"/></svg>
                                            </button>
                                        </div>
                                    </div>
                                    <p class="intel-message" id="detail-intel-message">Configure TornStats to see estimated battle stats.</p>
                                    <div class="intel-grid">
                                        <div class="intel-stat">
                                            <span class="intel-label">Strength</span>
                                            <span class="intel-value" id="detail-intel-str">-</span>
                                        </div>
                                        <div class="intel-stat">
                                            <span class="intel-label">Defense</span>
                                            <span class="intel-value" id="detail-intel-def">-</span>
                                        </div>
                                        <div class="intel-stat">
                                            <span class="intel-label">Speed</span>
                                            <span class="intel-value" id="detail-intel-spd">-</span>
                                        </div>
                                        <div class="intel-stat">
                                            <span class="intel-label">Dexterity</span>
                                            <span class="intel-value" id="detail-intel-dex">-</span>
                                        </div>
                                        <div class="intel-stat total">
                                            <span class="intel-label">Total</span>
                                            <span class="intel-value" id="detail-intel-total">-</span>
                                        </div>
                                    </div>
                                    <div class="intel-meta">
                                        <span class="intel-source" id="detail-intel-source"></span>
                                        <span class="intel-updated">
                                            <span id="detail-intel-updated">-</span>
                                            <span class="intel-freshness" id="detail-intel-freshness"></span>
                                        </span>
                                    </div>
                                </div>

                                <div class="detail-section">
                                    <h3>
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
                                        Attack Statistics
                                    </h3>
                                    <div class="detail-grid">
                                        <div class="detail-row">
                                            <span class="detail-label">Times Attacked</span>
                                            <span class="detail-value" id="detail-attack-count">0</span>
                                        </div>
                                        <div class="detail-row">
                                            <span class="detail-label">Last Attacked</span>
                                            <span class="detail-value" id="detail-last-attacked">Never</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="detail-section">
                                    <h3>
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M13 3c-1.1 0-2 .9-2 2v3h-2v4h2v7h4v-7h2.52L18 8h-3V5c0-.55.45-1 1-1h2V0h-3c-1.66 0-3 1.34-3 3z"/></svg>
                                        History
                                    </h3>
                                    <div class="detail-history" id="detail-history-list">
                                        <div class="history-empty">No interactions yet</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column - Notes & Group -->
                            <div class="detail-column">
                                <div class="detail-section">
                                        <h3>
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg>
                                            Group
                                        </h3>
                                        <select class="detail-select" id="detail-group">
                                            <!-- Options populated dynamically -->
                                        </select>
                                    </div>

                                    <div class="detail-section">
                                        <h3>
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                                            Custom Name
                                        </h3>
                                        <input type="text" class="detail-input" id="detail-custom-name" placeholder="Enter custom name...">
                                    </div>

                                    <div class="detail-section">
                                        <h3>
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 17c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7zM11 6h2v6h-2zm0 8h2v2h-2z"/></svg>
                                            Status Alerts
                                        </h3>
                                        <label class="monitor-toggle">
                                            <input type="checkbox" id="detail-monitor-ok">
                                            <span class="monitor-thumb"></span>
                                            <div class="monitor-copy">
                                                <span class="monitor-title">Notify when OK</span>
                                                <span class="monitor-sub">Toast when this target leaves hospital or jail.</span>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="detail-section notes-section">
                                        <h3>
                                            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 3H4.99c-1.11 0-1.98.89-1.98 2L3 19c0 1.1.88 2 1.99 2H19c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2zm0 12h-4c0 1.66-1.35 3-3 3s-3-1.34-3-3H4.99V5H19v10z"/></svg>
                                            Notes
                                        </h3>
                                        <div class="notes-templates">
                                            <button class="template-chip" type="button" data-notes-template="stealth">Stealth opener</button>
                                            <button class="template-chip" type="button" data-notes-template="breaker">Armor breaker</button>
                                            <button class="template-chip" type="button" data-notes-template="chain">Chain finisher</button>
                                        </div>
                                        <textarea class="detail-textarea" id="detail-notes" placeholder="Add notes about this target..."></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- No Selection State -->
                    <div class="no-selection" id="no-selection">
                        <div class="no-selection-content">
                            <div class="welcome-shell">
                                <div class="welcome-ambient"></div>
                                <div class="welcome-core">
                                    <!-- Header Section -->
                                    <div class="welcome-header-section">
                                        <div class="welcome-badge">
                                            <span class="badge-dot"></span>
                                            <span>Target Command Center</span>
                                        </div>
                                        <h1 class="welcome-title" id="welcome-main-title">Ready to Track Your Targets</h1>
                                        <p class="welcome-description" id="welcome-main-description">Add your first target to unlock real-time intelligence, instant status alerts, and powerful tracking capabilities.</p>
                                    </div>

                                    <!-- Bento Grid Layout -->
                                    <div class="welcome-bento-grid">
                                        <!-- Main CTA Card -->
                                        <div class="bento-card bento-main-cta">
                                            <div class="card-glow-effect"></div>
                                            <div class="bento-icon-large">
                                                <div class="icon-rings">
                                                    <div class="ring-orbit ring-1"></div>
                                                    <div class="ring-orbit ring-2"></div>
                                                    <div class="ring-orbit ring-3"></div>
                                                </div>
                                                <img src="assets/logomain.png" alt="Target" class="target-icon-main">
                                            </div>
                                            <h2 id="welcome-cta-title">Start Tracking</h2>
                                            <p id="welcome-cta-description">Add targets and monitor their status in real-time with precision tracking</p>
                                            <div class="cta-buttons">
                                                <button class="action-btn primary large" id="btn-add-first">
                                                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                                                    <span>Add Target</span>
                                                </button>
                                                <button class="action-btn secondary large" id="btn-bulk-first">
                                                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"/></svg>
                                                    <span>Bulk Import</span>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Live Pulses Feature Card -->
                                        <div class="bento-card bento-feature">
                                            <div class="feature-icon-wrapper pulse-icon">
                                                <div class="pulse-rings">
                                                    <span class="pulse-ring"></span>
                                                    <span class="pulse-ring"></span>
                                                    <span class="pulse-ring"></span>
                                                </div>
                                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/></svg>
                                            </div>
                                            <h3>Live Pulses</h3>
                                            <p>Real-time status updates delivered instantly as they happen</p>
                                        </div>

                                        <!-- Instant Alerts Feature Card -->
                                        <div class="bento-card bento-feature">
                                            <div class="feature-icon-wrapper alert-icon">
                                                <div class="alert-glow"></div>
                                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/></svg>
                                            </div>
                                            <h3>Instant Alerts</h3>
                                            <p>Get notified when targets become available for attack</p>
                                        </div>

                                        <!-- Smart Grouping Feature Card -->
                                        <div class="bento-card bento-feature">
                                            <div class="feature-icon-wrapper group-icon">
                                                <div class="group-grid">
                                                    <span class="grid-dot"></span>
                                                    <span class="grid-dot"></span>
                                                    <span class="grid-dot"></span>
                                                    <span class="grid-dot"></span>
                                                </div>
                                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
                                            </div>
                                            <h3>Smart Grouping</h3>
                                            <p>Organize targets efficiently with custom groups and filters</p>
                                        </div>

                                        <!-- Export & Share Feature Card -->
                                        <div class="bento-card bento-feature">
                                            <div class="feature-icon-wrapper export-icon">
                                                <div class="export-arrows">
                                                    <span class="arrow-line"></span>
                                                    <span class="arrow-line"></span>
                                                </div>
                                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/></svg>
                                            </div>
                                            <h3>Export & Share</h3>
                                            <p>Export intel and share target data with your team members</p>
                                        </div>

                                        <!-- Stats Preview Card -->
                                        <div class="bento-card bento-stats">
                                            <div class="stats-preview">
                                                <div class="stat-item">
                                                    <div class="stat-value" id="welcome-stat-targets">0</div>
                                                    <div class="stat-label">Active Targets</div>
                                                </div>
                                                <div class="stat-divider"></div>
                                                <div class="stat-item">
                                                    <div class="stat-value" id="welcome-stat-attackable">0</div>
                                                    <div class="stat-label">Attackable</div>
                                                </div>
                                                <div class="stat-divider"></div>
                                                <div class="stat-item">
                                                    <div class="stat-value" id="welcome-stat-status">Ready</div>
                                                    <div class="stat-label">System Status</div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Quick Tips Card -->
                                        <div class="bento-card bento-tips">
                                            <h3>Quick Start Guide</h3>
                                            <div class="tips-list">
                                                <div class="tip-item">
                                                    <span class="tip-number">1</span>
                                                    <span class="tip-text">Add targets using their Torn ID or import in bulk</span>
                                                </div>
                                                <div class="tip-item">
                                                    <span class="tip-number">2</span>
                                                    <span class="tip-text">Monitor live status updates and attack windows</span>
                                                </div>
                                                <div class="tip-item">
                                                    <span class="tip-number">3</span>
                                                    <span class="tip-text">Use groups to organize and prioritize your targets</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="welcome-foot"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Panel -->
                <div class="content-panel" id="panel-history">
                    <div class="panel-container">
                        <div class="panel-header">
                            <h2>Attack History</h2>
                            <p class="panel-description">Premium timeline of your recent attacks</p>
                        </div>

                        <div class="history-toolbar">
                            <div class="history-pills" id="history-range">
                                <button class="pill active" data-history-range="24h">24h</button>
                                <button class="pill" data-history-range="7d">7d</button>
                                <button class="pill" data-history-range="30d">30d</button>
                                <button class="pill" data-history-range="all">All</button>
                            </div>
                            <div class="history-search">
                                <input type="text" class="form-input" id="history-search" placeholder="Filter by name, ID, or group">
                            </div>
                        </div>

                        <div class="history-stat-grid">
                            <div class="history-stat-card" id="history-stat-total"></div>
                            <div class="history-stat-card" id="history-stat-unique"></div>
                            <div class="history-stat-card" id="history-stat-streak"></div>
                            <div class="history-stat-card" id="history-stat-top"></div>
                        </div>

                        <div class="history-list" id="history-list">
                            <!-- History items rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Statistics Panel -->
                <div class="content-panel" id="panel-statistics">
                    <div class="panel-container">
                        <div class="panel-header">
                            <h2>Statistics Dashboard</h2>
                            <p class="panel-description">Real-time insights and analytics for your target tracking</p>
                        </div>

                        <!-- Premium Stats Grid -->
                        <div class="stats-premium-layout">
                            <div class="stats-hero-section" id="stats-hero"></div>
                            <div class="stats-metrics-grid" id="stats-metrics-grid"></div>
                        </div>

                        <!-- Charts Section -->
                        <div class="stats-charts-container">
                            <div class="stats-chart-card">
                                <div class="stats-chart-header">
                                    <div class="stats-chart-title">
                                        <svg viewBox="0 0 24 24" class="stats-chart-icon"><path fill="currentColor" d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/></svg>
                                        <h3>Attack Trend</h3>
                                    </div>
                                    <span class="stats-chart-note" id="attack-trend-note"></span>
                                </div>
                                <div class="bar-chart" id="attack-trend-chart"></div>
                            </div>
                            <div class="stats-chart-card">
                                <div class="stats-chart-header">
                                    <div class="stats-chart-title">
                                        <svg viewBox="0 0 24 24" class="stats-chart-icon"><path fill="currentColor" d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
                                        <h3>Group Distribution</h3>
                                    </div>
                                    <span class="stats-chart-note" id="group-distribution-note"></span>
                                </div>
                                <div class="bar-chart horizontal" id="group-distribution-chart"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Loot Timer Panel -->
                <div class="content-panel" id="panel-loot-timer">
                    <div class="panel-container">
                        <div class="panel-header">
                            <h2>NPC Loot Timer</h2>
                            <p class="panel-description">Track loot levels for Torn NPCs/bosses</p>
                        </div>

                        <div class="loot-timer-info">
                            <div class="info-card">
                                <svg viewBox="0 0 24 24" class="info-icon"><path fill="currentColor" d="M11 7h2v2h-2V7zm0 4h2v6h-2v-6zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/></svg>
                                <div class="info-content">
                                    <strong>Loot Level System:</strong> NPCs drop loot when defeated. The loot level increases over time:
                                    <span class="loot-levels-info">Level I (0m) â†’ Level II (30m) â†’ Level III (90m) â†’ Level IV (210m) â†’ Level V (450m)</span>
                                </div>
                            </div>
                        </div>

                        <div class="loot-bosses-grid" id="loot-bosses-grid">
                            <!-- Boss cards will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Settings Panel -->
                <div class="content-panel" id="panel-settings">
                    <div class="settings-container">
                        <div class="settings-header">
                            <h2>Settings</h2>
                        </div>

                        <!-- API Configuration -->
                        <div class="settings-section">
                            <h3>API Configuration</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Torn API Key</div>
                                    <div class="setting-description">Your Torn API key with at least "Public" access level.</div>
                                </div>
                                <div class="setting-control">
                                    <div class="api-key-row">
                                        <input type="password" class="setting-input api-key-input" id="setting-api-key" placeholder="Enter API key...">
                                        <button class="action-btn" id="btn-toggle-key-visibility" title="Show/Hide">
                                            <svg class="eye-show" viewBox="0 0 24 24"><path fill="currentColor" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                                            <svg class="eye-hide" viewBox="0 0 24 24" style="display:none;"><path fill="currentColor" d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/></svg>
                                        </button>
                                        <button class="action-btn primary" id="btn-validate-key">Validate</button>
                                    </div>
                                    <div class="api-key-status" id="api-key-status"></div>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">TornStats API Key (Optional)</div>
                                    <div class="setting-description">For real-time NPC loot timers. Get your key at <a href="https://www.tornstats.com" target="_blank" style="color: var(--vscode-accent-blue);">TornStats.com</a></div>
                                </div>
                                <div class="setting-control">
                                    <div class="api-key-row">
                                        <input type="password" class="setting-input api-key-input" id="setting-tornstats-key" placeholder="Enter TornStats API key...">
                                        <button class="action-btn" id="btn-toggle-tornstats-visibility" title="Show/Hide">
                                            <svg class="eye-show" viewBox="0 0 24 24"><path fill="currentColor" d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
                                            <svg class="eye-hide" viewBox="0 0 24 24" style="display:none;"><path fill="currentColor" d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/></svg>
                                        </button>
                                        <button class="action-btn primary" id="btn-validate-tornstats-key">Validate</button>
                                    </div>
                                    <div class="api-key-status" id="tornstats-key-status"></div>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Your Level</div>
                                    <div class="setting-description">Used to rate target difficulty. Auto-filled when you validate your API key.</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-player-level" min="1" placeholder="Enter your level">
                                </div>
                            </div>
                        </div>

                        <!-- Refresh Settings -->
                        <div class="settings-section">
                            <h3>Refresh Settings</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Auto Refresh</div>
                                    <div class="setting-description">Automatically refresh target statuses.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-auto-refresh">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Refresh Interval</div>
                                    <div class="setting-description">Seconds between auto-refreshes (10-300).</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-refresh-interval" min="10" max="300" value="30">
                                    <span class="setting-unit">seconds</span>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Concurrent Requests</div>
                                    <div class="setting-description">Maximum simultaneous API requests (1-5).</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-concurrent" min="1" max="5" value="3">
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">API Rate Limit</div>
                                    <div class="setting-description">Requests per minute used for Torn API calls (max 99).</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-api-rate-limit" min="1" max="99" value="80">
                                    <span class="setting-unit">req/min</span>
                                </div>
                            </div>
                        </div>

                        <!-- Notifications -->
                        <div class="settings-section">
                            <h3>Notifications</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Desktop Notifications</div>
                                    <div class="setting-description">Show notifications when targets become attackable.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-notifications">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Sound Effects</div>
                                    <div class="setting-description">Play sound with notifications.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-sound">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Only Notify Monitored Targets</div>
                                    <div class="setting-description">Only show notifications for targets marked as monitored.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-notify-monitored">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Notify on Hospital Release</div>
                                    <div class="setting-description">Show notification when targets leave hospital.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-notify-hospital">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Notify on Jail Release</div>
                                    <div class="setting-description">Show notification when targets leave jail.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-notify-jail">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Display -->
                        <div class="settings-section">
                            <h3>Display</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Theme</div>
                                    <div class="setting-description">Choose application color scheme.</div>
                                </div>
                                <div class="setting-control">
                                    <select class="setting-select" id="setting-theme">
                                        <option value="dark">Dark</option>
                                        <option value="light">Light</option>
                                        <option value="auto">Auto (System)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">List Density</div>
                                    <div class="setting-description">Spacing and size of target list items.</div>
                                </div>
                                <div class="setting-control">
                                    <select class="setting-select" id="setting-list-density">
                                        <option value="compact">Compact</option>
                                        <option value="comfortable">Comfortable</option>
                                        <option value="spacious">Spacious</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Show Avatars</div>
                                    <div class="setting-description">Display target profile pictures in list.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-show-avatars">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Show Offline Targets</div>
                                    <div class="setting-description">Display targets that are not currently online.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-show-offline">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Show Status Count Badges</div>
                                    <div class="setting-description">Display count badges on filter buttons.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-show-badges">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Timestamp Format</div>
                                    <div class="setting-description">Time display format for last action times.</div>
                                </div>
                                <div class="setting-control">
                                    <select class="setting-select" id="setting-timestamp-format">
                                        <option value="12h">12-hour (AM/PM)</option>
                                        <option value="24h">24-hour</option>
                                        <option value="relative">Relative (ago)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Remember Sort Settings</div>
                                    <div class="setting-description">Keep your last sort preferences when restarting.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-sort-remember">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Compact Mode (Legacy)</div>
                                    <div class="setting-description">Use original compact display mode.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-compact">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Behavior -->
                        <div class="settings-section">
                            <h3>Behavior</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Confirm Before Attack</div>
                                    <div class="setting-description">Show confirmation dialog before opening attack page.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-confirm-attack">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Confirm Before Delete</div>
                                    <div class="setting-description">Show confirmation when deleting targets.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-confirm-delete">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Play Sound on Attack</div>
                                    <div class="setting-description">Play sound effect when opening attack page.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-attack-sound">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Show Onboarding on Launch</div>
                                    <div class="setting-description">Automatically open the interactive launch guide when the app starts.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-show-onboarding">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Window & Tray -->
                        <div class="settings-section">
                            <h3>Window &amp; Tray</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Start Minimized</div>
                                    <div class="setting-description">Keep the app in the background on launch.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-start-minimized">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Minimize to Tray</div>
                                    <div class="setting-description">Closing the window sends the app to the system tray.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-minimize-tray">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Data Management -->
                        <div class="settings-section">
                            <h3>Data Management</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Auto Backup</div>
                                    <div class="setting-description">Automatically create backups periodically.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-auto-backup">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Backup Interval</div>
                                    <div class="setting-description">Days between automatic backups (1-30).</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-backup-interval" min="1" max="30" value="7">
                                    <span class="setting-unit">days</span>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Backup Retention</div>
                                    <div class="setting-description">Maximum number of backup files to keep (3-50).</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-backup-retention" min="3" max="50" value="10">
                                    <span class="setting-unit">files</span>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Pre-change Backups</div>
                                    <div class="setting-description">Create a backup automatically before bulk delete and imports.</div>
                                </div>
                                <div class="setting-control">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-backup-preop">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="setting-item cloud-backup-row">
                                <div class="setting-info">
                                    <div class="setting-label">Cloud Backup</div>
                                    <div class="setting-description">Copy backups into a synced Google Drive or Dropbox folder.</div>
                                    <div class="setting-path" id="cloud-backup-path">No folder selected</div>
                                </div>
                                <div class="setting-control cloud-backup-controls">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="setting-cloud-backup">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <select id="setting-cloud-provider" class="setting-input setting-select">
                                        <option value="google-drive">Google Drive</option>
                                        <option value="dropbox">Dropbox</option>
                                    </select>
                                    <button class="action-btn ghost" id="btn-cloud-path">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M10 17h4v-3h3l-5-5-5 5h3z"/><path fill="currentColor" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg>
                                        Choose Folder
                                    </button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Max History Entries</div>
                                    <div class="setting-description">Maximum attack history entries to keep (100-10000).</div>
                                </div>
                                <div class="setting-control">
                                    <input type="number" class="setting-input setting-number" id="setting-max-history" min="100" max="10000" step="100" value="1000">
                                    <span class="setting-unit">entries</span>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Export Targets</div>
                                    <div class="setting-description">Save your targets to a JSON file.</div>
                                </div>
                                <div class="setting-control">
                                    <button class="action-btn" id="btn-export">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/></svg>
                                        Export
                                    </button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Import Targets</div>
                                    <div class="setting-description">Load targets from a JSON file.</div>
                                </div>
                                <div class="setting-control">
                                    <button class="action-btn" id="btn-import">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6-.67l2.59 2.58L17 12.5l-5-5-5 5 1.41 1.41L11 11.33V21h2z"/></svg>
                                        Import
                                    </button>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Create Backup</div>
                                    <div class="setting-description">Manually create a backup of all data.</div>
                                </div>
                                <div class="setting-control">
                                    <button class="action-btn" id="btn-backup">
                                        <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
                                        Backup Now
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- About -->
                        <div class="settings-section">
                            <h3>About</h3>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Version</div>
                                    <div class="setting-description">Torn Target Tracker</div>
                                </div>
                                <div class="setting-control">
                                    <span id="app-version">2.0.0</span>
                                </div>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-label">Data Location</div>
                                    <div class="setting-description">Where your data is stored.</div>
                                </div>
                                <div class="setting-control">
                                    <span id="data-path" class="data-path">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ================================================================
             STATUS BAR
             ================================================================ -->
        <div id="status-bar">
            <div class="status-left">
                <div class="status-item" id="status-connection" title="Live connection health">
                    <svg viewBox="0 0 32 32" class="wifi-icon" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="wifi-stat-grad-1" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" class="grad-start-1"/>
                                <stop offset="100%" class="grad-end-1"/>
                            </linearGradient>
                            <linearGradient id="wifi-stat-grad-2" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" class="grad-start-2"/>
                                <stop offset="100%" class="grad-end-2"/>
                            </linearGradient>
                            <linearGradient id="wifi-stat-grad-3" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" class="grad-start-3"/>
                                <stop offset="100%" class="grad-end-3"/>
                            </linearGradient>
                        </defs>
                        <circle cx="16" cy="26" r="2" fill="url(#wifi-stat-grad-1)" class="wifi-dot"/>
                        <path d="M11 22c1.4-1.4 3.2-2.2 5-2.2s3.6 0.8 5 2.2" stroke="url(#wifi-stat-grad-1)" stroke-width="2.5" fill="none" stroke-linecap="round" class="wifi-curve wifi-curve-1" data-level="1"/>
                        <path d="M7 18c2.4-2.4 5.6-3.8 9-3.8s6.6 1.4 9 3.8" stroke="url(#wifi-stat-grad-2)" stroke-width="2.5" fill="none" stroke-linecap="round" class="wifi-curve wifi-curve-2" data-level="2"/>
                        <path d="M3 14c3.5-3.5 8.2-5.5 13-5.5s9.5 2 13 5.5" stroke="url(#wifi-stat-grad-3)" stroke-width="2.5" fill="none" stroke-linecap="round" class="wifi-curve wifi-curve-3" data-level="3"/>
                    </svg>
                    <span id="status-connection-text">Connected</span>
                    <div class="status-signal-badges" id="status-signal-badges">
                        <span data-signal="internet" title="Internet">NET</span>
                        <span data-signal="api" title="Torn API">API</span>
                        <span data-signal="stats" title="TornStats API">STS</span>
                    </div>
                </div>
                <div class="status-item" id="status-next-refresh" title="Auto refresh status">
                    <svg viewBox="0 0 24 24" class="status-inline-icon"><path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                    <span id="status-next-refresh-text">Calculating...</span>
                    <span class="status-chip subtle" id="status-refresh-mode-chip">Auto</span>
                </div>
                <div class="status-item refresh-progress" id="status-refresh">
                    <div class="spinner"></div>
                    <span id="refresh-text">Refreshing...</span>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <button class="status-cancel-btn" id="btn-cancel-refresh" title="Cancel">&times;</button>
                </div>
            </div>
            <div class="status-right">
                <div class="status-item clickable" id="status-attackable" title="Attackable targets">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
                    <span id="attackable-text">0 attackable</span>
                </div>
                <div class="status-item" id="status-targets">
                    <span id="targets-text">0 targets</span>
                </div>
                <div class="status-item" id="status-rate">
                    <span id="rate-text">Rate: 100/min</span>
                    <div class="rate-popover" id="rate-popover">
                        <div class="rate-popover-header">API Rate Limit</div>
                        <div class="rate-popover-content">
                            <div class="rate-popover-row">
                                <span class="rate-popover-label">Available:</span>
                                <span class="rate-popover-value" id="rate-popover-available">--</span>
                            </div>
                            <div class="rate-popover-row">
                                <span class="rate-popover-label">Recent Requests:</span>
                                <span class="rate-popover-value" id="rate-popover-recent">--</span>
                            </div>
                            <div class="rate-popover-row">
                                <span class="rate-popover-label">Utilization:</span>
                                <span class="rate-popover-value" id="rate-popover-utilization">--</span>
                            </div>
                            <div class="rate-popover-row" id="rate-popover-penalty-row" style="display: none;">
                                <span class="rate-popover-label">Penalty:</span>
                                <span class="rate-popover-value" id="rate-popover-penalty">--</span>
                            </div>
                            <div class="rate-popover-divider"></div>
                            <div class="rate-popover-row">
                                <span class="rate-popover-label">Success:</span>
                                <span class="rate-popover-value" id="rate-popover-success">--</span>
                            </div>
                            <div class="rate-popover-row">
                                <span class="rate-popover-label">Failed:</span>
                                <span class="rate-popover-value" id="rate-popover-failed">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Command Palette -->
    <div class="command-palette-overlay" id="command-palette-overlay">
        <div class="command-palette" role="dialog" aria-modal="true" aria-label="Command Palette">
            <div class="command-palette-header">
                <input type="text" id="command-palette-input" placeholder="Type a command or search actions..." autocomplete="off" spellcheck="false">
                <span class="command-palette-hint">Ctrl+Shift+P</span>
            </div>
            <div class="command-palette-list" id="command-palette-list"></div>
            <div class="command-palette-empty" id="command-palette-empty">No commands match that search.</div>
        </div>
    </div>

    <!-- ====================================================================
         MODALS
         ==================================================================== -->

    <!-- Add Target Modal -->
    <div class="modal-overlay" id="modal-add-target">
        <div class="modal">
            <div class="modal-header">
                <h3>Add Target</h3>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">User ID or Profile URL *</label>
                    <input type="text" class="form-input" id="input-target-id" placeholder="Enter ID, profile URL, or attack URL...">
                    <div class="form-hint">Examples: 123456, https://www.torn.com/profiles.php?XID=123456</div>
                    <div class="form-error" id="error-target-id"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">Custom Name (optional)</label>
                    <input type="text" class="form-input" id="input-target-name" placeholder="Give them a nickname...">
                </div>
                <div class="form-group">
                    <label class="form-label">Group</label>
                    <select class="form-select" id="input-target-group">
                        <!-- Options populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Notes (optional)</label>
                    <textarea class="form-textarea" id="input-target-notes" placeholder="Add notes..." rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" data-close-modal>Cancel</button>
                <button class="action-btn primary" id="btn-confirm-add">Add Target</button>
            </div>
        </div>
    </div>

    <!-- Bulk Add Modal -->
    <div class="modal-overlay" id="modal-bulk-add">
        <div class="modal modal-large">
            <div class="modal-header">
                <h3>Bulk Import Targets</h3>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Enter User IDs or URLs</label>
                    <textarea class="form-textarea bulk-textarea" id="input-bulk-ids" placeholder="Enter user IDs, profile URLs, or attack URLs - one per line or comma separated...

Examples:
123456
https://www.torn.com/profiles.php?XID=789012
https://www.torn.com/loader.php?sid=attack&user2ID=345678
456789, 012345, 678901" rows="10"></textarea>
                    <div class="form-hint">
                        <strong>Supported formats:</strong> Raw IDs, Profile URLs, Attack URLs, Torn profile links [Name [ID]]
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Add to Group</label>
                    <select class="form-select" id="input-bulk-group">
                        <!-- Options populated dynamically -->
                    </select>
                </div>
                <div class="bulk-preview" id="bulk-preview" style="display: none;">
                    <div class="bulk-preview-header">
                        <span class="bulk-valid" id="bulk-valid-count">0 valid IDs found</span>
                        <span class="bulk-invalid" id="bulk-invalid-count">0 invalid</span>
                    </div>
                    <div class="bulk-preview-list" id="bulk-preview-list"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" data-close-modal>Cancel</button>
                <button class="action-btn" id="btn-preview-bulk">Preview</button>
                <button class="action-btn primary" id="btn-confirm-bulk" disabled>Import Targets</button>
            </div>
        </div>
    </div>

    <!-- Add Group Modal -->
    <div class="modal-overlay" id="modal-add-group">
        <div class="modal modal-small">
            <div class="modal-header">
                <h3>Add Group</h3>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Group Name *</label>
                    <input type="text" class="form-input" id="input-group-name" placeholder="Enter group name...">
                </div>
                <div class="form-group">
                    <label class="form-label">Color</label>
                    <div class="color-picker">
                        <input type="color" id="input-group-color" value="#007acc">
                        <span class="color-preview" id="color-preview"></span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" data-close-modal>Cancel</button>
                <button class="action-btn primary" id="btn-confirm-group">Create Group</button>
            </div>
        </div>
    </div>

    <!-- Edit Group Modal -->
    <div class="modal-overlay" id="modal-edit-group">
        <div class="modal modal-small">
            <div class="modal-header">
                <h3>Edit Group</h3>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Group Name *</label>
                    <input type="text" class="form-input" id="input-edit-group-name" placeholder="Enter group name...">
                </div>
                <div class="form-group">
                    <label class="form-label">Color</label>
                    <div class="color-picker">
                        <input type="color" id="input-edit-group-color" value="#007acc">
                        <span class="color-preview" id="edit-color-preview"></span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" data-close-modal>Cancel</button>
                <button class="action-btn primary" id="btn-confirm-edit-group">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <div class="modal-overlay" id="modal-about">
        <div class="modal modal-large">
            <div class="modal-header">
                <h3>About Torn Target Tracker</h3>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body about-body">
                <div class="about-summary">
                    <div class="about-title">Torn Target Tracker</div>
                    <div class="about-version">Version <span id="about-version">-</span></div>
                    <div class="about-path" title="Data path">
                        Data: <span id="about-data-path">-</span>
                    </div>
                    <div class="about-meta">
                        Developed by Robin Doak - (<a href="https://www.torn.com/profiles.php?XID=3212954" target="_blank" rel="noopener noreferrer">Skillerious</a>)
                    </div>
                    <div class="about-disclaimer">
                        This is a fan-made tool and is not affiliated with Torn.com, Torntools.com, or the Torn developers.
                    </div>
                </div>
                <div class="about-grid">
                    <div class="about-card">
                        <div class="about-card-label">Targets</div>
                        <div class="about-card-value" id="about-targets-count">0</div>
                        <div class="about-card-meta">Total stored</div>
                    </div>
                    <div class="about-card">
                        <div class="about-card-label">Attackable</div>
                        <div class="about-card-value accent" id="about-attackable-count">0</div>
                        <div class="about-card-meta">Currently OK</div>
                    </div>
                    <div class="about-card">
                        <div class="about-card-label">Refresh Rate</div>
                        <div class="about-card-value" id="about-refresh-interval">-</div>
                        <div class="about-card-meta">Seconds</div>
                    </div>
                    <div class="about-card">
                        <div class="about-card-label">API Status</div>
                        <div class="about-card-value" id="about-api-status">Online</div>
                        <div class="about-card-meta">Last sync <span id="about-last-refresh">-</span></div>
                    </div>
                </div>
                <div class="about-footer">
                    <div class="about-tag">Encrypted storage</div>
                    <div class="about-tag">Rate limited</div>
                    <div class="about-tag">Multi-platform</div>
                    <div class="about-tag">VS Code theme</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="action-btn" data-close-modal>Close</button>
                <button class="action-btn primary" id="about-open-log">Open Logs</button>
            </div>
        </div>
    </div>

    <!-- Confirm Dialog -->
    <div class="modal-overlay" id="modal-confirm">
        <div class="modal confirm-modal modal-small">
            <div class="modal-header confirm-header">
                <div class="confirm-icon">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
                </div>
                <div class="confirm-heading">
                    <p class="confirm-eyebrow">Irreversible</p>
                    <h3 id="confirm-title">Remove Target</h3>
                </div>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="modal-body confirm-body">
                <p id="confirm-message" class="confirm-message">Are you sure?</p>
                <div class="confirm-warning">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
                    <span>This removes the target, notes, and monitoring. This cannot be undone.</span>
                </div>
                <div class="confirm-details">
                    <div class="confirm-chip">Removes from all groups</div>
                    <div class="confirm-chip">Clears status watch</div>
                    <div class="confirm-chip">Deletes local notes</div>
                </div>
            </div>
            <div class="modal-footer confirm-footer">
                <button class="action-btn ghost" data-close-modal id="confirm-cancel">Keep Target</button>
                <button class="action-btn danger" id="confirm-ok">Remove</button>
            </div>
        </div>
    </div>

    <!-- Attack Prevention Dialog -->
    <div class="modal-overlay" id="modal-attack-prevention">
        <div class="modal attack-prevention-modal">
            <div class="attack-prevention-header">
                <div class="attack-prevention-icon" id="attack-prevention-icon">
                    <img src="assets/hospital.png" alt="Status Icon">
                </div>
                <div class="attack-prevention-status">
                    <h2 id="attack-prevention-title">Cannot Attack</h2>
                    <span class="status-badge" id="attack-prevention-badge">HOSPITAL</span>
                </div>
                <button class="modal-close" data-close-modal>
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="attack-prevention-body">
                <div class="attack-prevention-message" id="attack-prevention-message">
                    This user is currently in the hospital. You cannot attack them at this time.
                </div>
                <div class="attack-prevention-timer" id="attack-prevention-timer" style="display: none;">
                    <div class="timer-label">Time Remaining</div>
                    <div class="timer-value" id="attack-prevention-timer-value">5m 32s</div>
                    <div class="timer-available" id="attack-prevention-available">Available at 12:34 PM</div>
                </div>
                <div class="attack-prevention-details" id="attack-prevention-details">
                    <div class="detail-item">
                        <span class="detail-label">Target:</span>
                        <span class="detail-value" id="attack-prevention-target-name">Unknown</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value" id="attack-prevention-status-text">Hospital</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Reason:</span>
                        <span class="detail-value" id="attack-prevention-reason">-</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer attack-prevention-footer">
                <button class="action-btn ghost notify-release-btn" id="attack-prevention-notify">Notify when released</button>
                <button class="action-btn primary" data-close-modal id="attack-prevention-ok">Understood</button>
            </div>
        </div>
    </div>

    <!-- Target Context Menu -->
    <div class="context-menu" id="context-menu">
        <div class="context-menu-item" data-action="select-all">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M4 5h16v2H4V5zm0 6h16v2H4v-2zm0 6h16v2H4v-2z"/></svg>
            <span>Select All</span>
        </div>
        <div class="context-menu-item" data-action="clear-selection">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm3.46-8.12L12 13.42l2.54-2.54 1.41 1.42L13.42 14.83l2.53 2.53-1.41 1.42L12 16.25l-2.54 2.53-1.41-1.42 2.53-2.53-2.53-2.54 1.41-1.41zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            <span>Clear Selection</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="attack">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
            <span>Attack</span>
            <span class="context-shortcut">Enter</span>
        </div>
        <div class="context-menu-item" data-action="profile">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            <span>View Profile</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="favorite">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <span>Toggle Favorite</span>
        </div>
        <div class="context-menu-item" data-action="toggle-watch">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6V11c0-3.07-1.63-5.64-4.5-6.32V4a1.5 1.5 0 1 0-3 0v.68C7.64 5.36 6 7.92 6 11v5l-1.8 1.8a.5.5 0 0 0 .35.85h13c.45 0 .67-.54.35-.85L18 16z"/></svg>
            <span>Watch Status</span>
        </div>
        <div class="context-menu-item has-submenu" data-action="move-to-group">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"/></svg>
            <span>Move to Group</span>
            <svg class="submenu-arrow" viewBox="0 0 24 24"><path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
            <div class="context-submenu" id="group-submenu">
                <!-- Groups populated dynamically -->
            </div>
        </div>
        <div class="context-menu-item" data-action="add-tags">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 17h3l7-7-3-3-7 7v3zm9.7-8.3 1.3-1.3c.39-.39.39-1.02 0-1.41L16.01 3.3c-.39-.39-1.02-.39-1.41 0l-1.29 1.29 3 3zM5 19h4v2H5c-1.1 0-2-.9-2-2v-4h2v4z"/></svg>
            <span>Add Tags to Selection</span>
        </div>
        <div class="context-menu-item" data-action="remove-from-group">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-1 12H5c-.55 0-1-.45-1-1V9c0-.55.45-1 1-1h14c.55 0 1 .45 1 1v8c0 .55-.45 1-1 1zm-7-8l-4 4h2.5v3h3v-3H16z"/></svg>
            <span>Remove from Group</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="refresh">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
            <span>Refresh</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item danger" data-action="remove">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            <span>Remove</span>
            <span class="context-shortcut">Del</span>
        </div>
    </div>

    <!-- Group Context Menu -->
    <div class="context-menu" id="group-context-menu">
        <div class="context-menu-item" data-action="flag-no-attack">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z"/></svg>
            <span>Flag: Do Not Attack</span>
        </div>
        <div class="context-menu-item" data-action="refresh-group">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
            <span>Refresh All in Group</span>
        </div>
        <div class="context-menu-item" data-action="attack-all">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
            <span>Attack All Attackable</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="watch-all">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6V11c0-3.07-1.63-5.64-4.5-6.32V4a1.5 1.5 0 1 0-3 0v.68C7.64 5.36 6 7.92 6 11v5l-1.8 1.8a.5.5 0 0 0 .35.85h13c.45 0 .67-.54.35-.85L18 16z"/></svg>
            <span>Watch Status (All)</span>
        </div>
        <div class="context-menu-item" data-action="unwatch-all">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6V11c0-3.07-1.63-5.64-4.5-6.32V4a1.5 1.5 0 1 0-3 0v.68C7.64 5.36 6 7.92 6 11v5l-1.8 1.8a.5.5 0 0 0 .35.85h13c.45 0 .67-.54.35-.85L18 16z"/><path fill="currentColor" d="M4 4l16 16-1.41 1.41L2.59 5.41z"/></svg>
            <span>Ignore Status (All)</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="mark-favorites">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            <span>Mark All as Favorite</span>
        </div>
        <div class="context-menu-item" data-action="export-group">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/></svg>
            <span>Export Group IDs</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="edit">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
            <span>Edit Group</span>
        </div>
        <div class="context-menu-item" data-action="duplicate">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
            <span>Duplicate Group</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item danger" data-action="delete">
            <svg viewBox="0 0 24 24"><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            <span>Delete Group</span>
        </div>
    </div>

    <!-- Onboarding Experience -->
    <div class="onboarding-overlay" id="onboarding-overlay" aria-hidden="true">
        <div class="onboarding-stars"></div>
        <div class="onboarding-orbit-lines"></div>
        <div class="onboarding-dialog">
            <button class="onboarding-close" id="onboarding-close" aria-label="Close onboarding">
                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            </button>
            <div class="onboarding-hero">
                <div class="onboarding-kicker">Launch Control</div>
                <h2>Welcome to Torn Target Tracker</h2>
                <p class="onboarding-subtitle">A guided, cinematic way to get your attack console online with zero guesswork. Follow the steps, watch the ambient cues, and you'll be tracking in seconds.</p>
                <div class="onboarding-badges">
                    <span class="badge">Real-time Intel</span>
                    <span class="badge badge-alt">Attack Windows</span>
                    <span class="badge">Live Pulse</span>
                </div>
                <div class="onboarding-orbital">
                    <div class="orbital-core">
                        <img src="assets/logomain.png" alt="Target Tracker Logo">
                        <div class="orbital-glow"></div>
                    </div>
                    <div class="orbital-ring ring-a"></div>
                    <div class="orbital-ring ring-b"></div>
                    <div class="orbital-ring ring-c"></div>
                    <div class="orbital-pip pip-1"></div>
                    <div class="orbital-pip pip-2"></div>
                    <div class="orbital-pip pip-3"></div>
                </div>
            </div>
            <div class="onboarding-body">
                <div class="onboarding-smart">
                    <div class="smart-header">
                        <div class="smart-dot"></div>
                        <div>
                            <div class="smart-kicker">Guided Setup</div>
                            <div class="smart-title" id="onboarding-smart-title">Next best step ready</div>
                        </div>
                    </div>
                    <div class="smart-copy" id="onboarding-smart-copy">We'll route you to the highest-impact action so you can finish setup without thinking.</div>
                    <div class="smart-status-grid">
                        <div class="smart-status" id="onboarding-status-key">
                            <span class="status-label">API Key</span>
                            <span class="status-value">Pending</span>
                        </div>
                        <div class="smart-status" id="onboarding-status-targets">
                            <span class="status-label">Targets</span>
                            <span class="status-value">0 added</span>
                        </div>
                        <div class="smart-status" id="onboarding-status-alerts">
                            <span class="status-label">Alerts</span>
                            <span class="status-value">Disabled</span>
                        </div>
                    </div>
                </div>
                <div class="onboarding-tabs" id="onboarding-tabs">
                    <button class="onboarding-tab active" data-onboarding-step="0">01 - Connect</button>
                    <button class="onboarding-tab" data-onboarding-step="1">02 - Add Targets</button>
                    <button class="onboarding-tab" data-onboarding-step="2">03 - Stay Alert</button>
                </div>
                <div class="onboarding-panels">
                    <div class="onboarding-step active" data-onboarding-step="0">
                        <div class="step-header">
                            <div class="step-eyebrow">Foundation</div>
                            <h3>Secure your API keys</h3>
                            <p>Drop in your Torn and TornStats keys to light up live statuses, loot timers, and attack-ready intel without leaving the cockpit.</p>
                        </div>
                        <div class="step-actions">
                            <button class="chip-btn" data-onboarding-action="open-settings">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19.14 12.94c.04-.31.06-.63.06-.94s-.02-.63-.06-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a6.97 6.97 0 0 0-1.63-.94L14.5 2h-5l-.25 2.24a6.97 6.97 0 0 0-1.63.94l-2.39-.96a.5.5 0 0 0-.6.22L2.21 8.16a.5.5 0 0 0 .12.64l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58a.5.5 0 0 0-.12.64l1.92 3.32c.13.22.4.3.64.22l2.39-.96c.5.38 1.05.7 1.63.94L9.5 22h5l.25-2.24c.58-.24 1.13-.56 1.63-.94l2.39.96c.24.08.51 0 .64-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58zM12 15a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/></svg>
                                Open Settings
                            </button>
                            <button class="chip-btn ghost" data-onboarding-action="validate-api">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                                Validate Key
                            </button>
                        </div>
                        <div class="step-metrics">
                            <div class="metric-card">
                                <span class="metric-label">Connection</span>
                                <span class="metric-value" id="onboarding-connection-status">Pending</span>
                            </div>
                            <div class="metric-card">
                                <span class="metric-label">Latency</span>
                                <span class="metric-value" id="onboarding-latency">-- ms</span>
                            </div>
                            <div class="metric-card">
                                <span class="metric-label">Rate</span>
                                <span class="metric-value" id="onboarding-rate">--/min</span>
                            </div>
                        </div>
                    </div>
                    <div class="onboarding-step" data-onboarding-step="1">
                        <div class="step-header">
                            <div class="step-eyebrow">Population</div>
                            <h3>Add your first targets</h3>
                            <p>Spin up your watchlist with a single ID or drop in a bulk file. The grid lights up instantly with live statuses and attack windows.</p>
                        </div>
                        <div class="step-actions">
                            <button class="chip-btn" data-onboarding-action="add-target">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"/></svg>
                                Add Target
                            </button>
                            <button class="chip-btn ghost" data-onboarding-action="bulk-add">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"/></svg>
                                Bulk Import
                            </button>
                        </div>
                        <div class="step-grid">
                            <div class="grid-card">
                                <span class="grid-label">Active Targets</span>
                                <span class="grid-value" id="onboarding-target-count">0</span>
                            </div>
                            <div class="grid-card">
                                <span class="grid-label">Attackable</span>
                                <span class="grid-value" id="onboarding-attackable-count">0</span>
                            </div>
                            <div class="grid-card">
                                <span class="grid-label">Groups Ready</span>
                                <span class="grid-value" id="onboarding-group-count">1</span>
                            </div>
                        </div>
                    </div>
                    <div class="onboarding-step" data-onboarding-step="2">
                        <div class="step-header">
                            <div class="step-eyebrow">Control</div>
                            <h3>Stay ready with alerts</h3>
                            <p>Enable notifications, watch targets, and keep the radar open. Every status change flows through to toasts, badges, and tray cues.</p>
                        </div>
                        <div class="step-actions">
                            <button class="chip-btn" data-onboarding-action="enable-notifications">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6V11c0-3.07-1.64-5.64-4.5-6.32V4a1.5 1.5 0 1 0-3 0v.68C7.64 5.36 6 7.92 6 11v5l-1.8 1.8a.5.5 0 0 0 .35.85h13c.45 0 .67-.54.35-.85L18 16z"/></svg>
                                Enable Notifications
                            </button>
                            <button class="chip-btn ghost" data-onboarding-action="open-loot">
                                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M12 2 2 7l10 5 10-5-10-5zm0 7.92L5.16 7 12 4.08 18.84 7 12 9.92zM2 9v6l10 5 10-5V9l-10 5-10-5z"/></svg>
                                See Loot Timer
                            </button>
                        </div>
                        <div class="step-checklist">
                            <div class="check-row">
                                <span class="check-dot"></span>
                                <span>Toast and sound alerts are <strong id="onboarding-notify-status">disabled</strong></span>
                            </div>
                            <div class="check-row">
                                <span class="check-dot"></span>
                                <span>Tray icon mirrors live attackable count</span>
                            </div>
                            <div class="check-row">
                                <span class="check-dot"></span>
                                <span>Connection monitor keeps API health in view</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="onboarding-footer">
                    <label class="onboarding-checkbox">
                        <input type="checkbox" id="onboarding-hide-toggle">
                        <span>Don't show this on startup</span>
                    </label>
                    <div class="onboarding-progress">
                        <div class="progress-bar" id="onboarding-progress-bar"></div>
                    </div>
                    <div class="onboarding-actions">
                        <button class="ghost-btn" id="onboarding-skip">Skip</button>
                        <div class="onboarding-nav">
                            <button class="ghost-btn" id="onboarding-prev" disabled>Back</button>
                            <button class="primary-btn" id="onboarding-next">Next</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium Alert Dialog -->
    <div class="premium-alert-overlay" id="premium-alert-overlay">
        <div class="premium-alert-dialog">
            <div class="premium-alert-header">
                <div class="premium-alert-icon" id="premium-alert-icon"></div>
                <h3 class="premium-alert-title" id="premium-alert-title"></h3>
            </div>
            <div class="premium-alert-content">
                <div class="premium-alert-message" id="premium-alert-message"></div>
            </div>
            <div class="premium-alert-actions" id="premium-alert-actions">
                <!-- Buttons rendered dynamically -->
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner large"></div>
            <span>Loading...</span>
        </div>
    </div>

    <!-- Connection Status Dialog -->
    <div class="connection-dialog-overlay" id="connection-dialog">
        <div class="connection-dialog">
            <div class="connection-dialog-header">
                <h3>Connection Status</h3>
                <button class="connection-dialog-close" id="close-connection-dialog">
                    <svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="connection-dialog-body">
                <!-- Torn API Connection -->
                <div class="connection-item" id="conn-torn-api">
                    <div class="connection-visual">
                        <div class="connection-node">
                            <div class="connection-node-inner"></div>
                            <div class="connection-pulse"></div>
                            <div class="connection-pulse delay-1"></div>
                            <div class="connection-pulse delay-2"></div>
                        </div>
                        <div class="connection-line">
                            <div class="connection-flow"></div>
                            <div class="connection-flow delay-1"></div>
                            <div class="connection-flow delay-2"></div>
                        </div>
                        <div class="connection-endpoint">
                            <svg viewBox="0 0 24 24">
                                <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="connection-info">
                        <div class="connection-title">Torn API</div>
                        <div class="connection-status">Checking...</div>
                        <div class="connection-details">
                            <div class="connection-detail" id="api-rate">
                                <span class="detail-label">Rate:</span>
                                <span class="detail-value">--/min</span>
                            </div>
                            <div class="connection-detail" id="api-latency">
                                <span class="detail-label">Latency:</span>
                                <span class="detail-value">-- ms</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Internet Connection -->
                <div class="connection-item" id="conn-internet">
                    <div class="connection-visual">
                        <div class="connection-node">
                            <div class="connection-node-inner"></div>
                            <div class="connection-pulse"></div>
                            <div class="connection-pulse delay-1"></div>
                            <div class="connection-pulse delay-2"></div>
                        </div>
                        <div class="connection-line">
                            <div class="connection-flow"></div>
                            <div class="connection-flow delay-1"></div>
                            <div class="connection-flow delay-2"></div>
                        </div>
                        <div class="connection-endpoint">
                            <svg viewBox="0 0 24 24">
                                <path fill="currentColor" d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="connection-info">
                        <div class="connection-title">Internet</div>
                        <div class="connection-status">Checking...</div>
                        <div class="connection-details">
                            <div class="connection-detail" id="net-status">
                                <span class="detail-label">Status:</span>
                                <span class="detail-value">Unknown</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TornStats API Connection -->
                <div class="connection-item" id="conn-tornstats">
                    <div class="connection-visual">
                        <div class="connection-node">
                            <div class="connection-node-inner"></div>
                            <div class="connection-pulse"></div>
                            <div class="connection-pulse delay-1"></div>
                            <div class="connection-pulse delay-2"></div>
                        </div>
                        <div class="connection-line">
                            <div class="connection-flow"></div>
                            <div class="connection-flow delay-1"></div>
                            <div class="connection-flow delay-2"></div>
                        </div>
                        <div class="connection-endpoint">
                            <svg viewBox="0 0 24 24">
                                <path fill="currentColor" d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="connection-info">
                        <div class="connection-title">TornStats API</div>
                        <div class="connection-status">Checking...</div>
                        <div class="connection-details">
                            <div class="connection-detail" id="stats-last-fetch">
                                <span class="detail-label">Last Fetch:</span>
                                <span class="detail-value">Never</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="src/api.js"></script>
    <script src="src/state.js"></script>
    <script src="src/app.js"></script>
</body>
</html>
